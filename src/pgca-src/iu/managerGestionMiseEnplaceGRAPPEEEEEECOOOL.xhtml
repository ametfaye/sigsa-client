<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui" template="template.pgca.xhtml">

	<ui:define name="title">Magasisier - PGCA - Plateforme de gestion Agricole</ui:define>



	<ui:define name="section">
		<p:spacer width="3%"></p:spacer>
		<div class="container-fluid">
			<div class="col-md-12">
			
				
				<p:messages id="msg" showDetail="true" />
				<h:form  id="cc" class="col-md-12" >

				
				<div id="container222" style="min-width: 310px; height: 400px; margin: 0 auto"></div>


				<p:messages id="messages" showDetail="false"
					style="width : 60% ; margin-left : 20%" />
				<br />
				<br />
				<br />

				<div class="col-xs-12">

					<div class="col-sm-4">
						<div class="form-group">
							<div class="col-lg-4" style="margin-top: 8px">

								<label for="inputEmail3" class="col-lg-12 control-label">Région</label>
							</div>

							<div class="col-lg-8">

								<h:selectOneMenu value="#{referentielMB.pointDeVente.idRegion}"
									required="true" styleClass="form-control input-sm CustomSelect"
									requiredMessage="La region est requise ">
									<f:selectItem itemLabel="Selectionnez une region " itemValue="" />
									<f:selectItems value="#{referentielMB.loadAllRegions()}"
										var="CollaborateurDTO" itemValue="#{CollaborateurDTO.clef}"
										itemLabel="#{CollaborateurDTO.valeur}" />

									<p:ajax event="change"
										listener="#{referentielMB.refreshDepartementByRegionId()}"
										update="deptList2 communList2" />
								</h:selectOneMenu>
							</div>
						</div>
					</div>


					<h:panelGroup id="deptList2">
						<div class="col-sm-4">
							<div class="form-group">
								<div class="col-lg-4" style="margin-top: 8px">
									<label for="inputEmail3" class="col-sm-1 control-label">Département</label>
								</div>

								<div class="col-lg-8">
									<h:selectOneMenu
										value="#{referentielMB.pointDeVente.idDepartement}"
										styleClass="form-control input-sm CustomSelect"
										requiredMessage="Le departement est requis">
										<f:selectItem itemLabel="Selectionnez un département"
											itemValue="" />
										<f:selectItems value="#{referentielMB.departements}"
											var="CollaborateurDTO" itemValue="#{CollaborateurDTO.clef}"
											itemLabel="#{CollaborateurDTO.valeur}" />
										<p:ajax event="change"
											listener="#{referentielMB.refreshCommunesByDepratementId()}"
											update="communList2" />

									</h:selectOneMenu>
								</div>
							</div>
						</div>
					</h:panelGroup>



					<h:panelGroup id="communList2">
						<div class="col-sm-4">
							<div class="form-group">
								<div class="col-lg-4" style="margin-top: 8px">
									<label for="inputEmail3" class="col-sm-1 control-label">Commune</label>
								</div>

								<div class="col-lg-8">
									<h:selectOneMenu value="#{managerManagedBean.nomCommune}"
										styleClass="form-control input-sm CustomSelect"
										requiredMessage="La commune est requise">
										<f:selectItem itemLabel="Selectionnez une commune"
											itemValue="" />
										<f:selectItems value="#{referentielMB.communes}"
											var="CollaborateurDTO"
											itemValue="#{CollaborateurDTO.clef}-#{CollaborateurDTO.valeur}"
											itemLabel="#{CollaborateurDTO.valeur}" />
										<p:ajax event="change"
											listener="#{managerManagedBean.loadAllMiseEnPlaceByIdCommune()}"
											update="msgg2 Suivi" />

									</h:selectOneMenu>
								</div>
							</div>
						</div>
						
						<script type="text/javascript">

Highcharts.chart('container222', {
    chart: {
        type: 'line'
    },
    title: {
        text: ' Suivi des mises en place par Zone'
    },
    subtitle: {
        text: 'Repartition par zone'
    },
    xAxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },
    yAxis: {
        title: {
            text: 'Taux de Mise en place (°%)'
        }
    },
    plotOptions: {
        line: {
            dataLabels: {
                enabled: true
            },
            enableMouseTracking: false
        }
    },
    series: [{
        name: 'Tokyo',
        data: [7.0, 6.9, 1.5, 34.5, 18.4, 21.5, 25.2, 26.5, 23.3]
    }, {
        name: 'London',
        data: [3.9, 4.2, 4.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2]
    }]
});






		</script>
		
		
		
		
					</h:panelGroup>



					<h:panelGroup id="msgg2">
						<br />
						<br />
						<hr />
						<h1 style="text-align: center">
							<span class="ui-label"> <a href="#"
								style="color: #029441; font-size: 17px;"> Commune de
									#{managerManagedBean.nomCommune} </a></span>
						</h1>
						<br />
						<div class="col-lg-3" />

						<div class="col-lg-8">


							<div class="col-lg-4">
								<div id="ui-widget"
									style="margin-left: 10px; height: 50%; width: 50%; box-shadow: inset 0 3px 0 rgb(34, 160, 88), inset 0 3px 5px rgba(0, 0, 0, .25)">
									<h1 class="ui-value">
										<a href="#" style="color: #029441;"
											title="2  Ordre (s) de livraison en attente de pour votre point de vente">
											#{managerManagedBean.totalMiseEnPlaceAffectuer} </a>
									</h1>
									<span class="ui-label"> <a href="#"
										style="color: #029441; font-size: 17px;"> MEP </a></span>
								</div>
							</div>


		
							<div class="col-lg-4">
										<div id="containerfaye" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>

							</div>


							<div class="col-lg-4">
								<div id="ui-widget"
									style="margin-left: 10px; height: 50%; width: 50%; box-shadow: inset 0 3px 0 rgb(34, 160, 88), inset 0 3px 5px rgba(0, 0, 0, .25)">
									<h1 class="ui-value">
										<a href="#" style="color: #029441;"
											title="2  Ordre (s) de livraison en attente de pour votre point de vente">
											#{managerManagedBean.totalCumulCommune} </a>
									</h1>
									<span class="ui-label"> <a href="#"
										style="color: #029441; font-size: 17px;"> Cumul </a></span>
								</div>
							</div>

							<br />


						</div>
						<br />
						<br />
						<br />
						<br />
						<br />
						<br />
						<br />
						
						
						
		
					</h:panelGroup>


					<!--  Liste des points des ventes trouvés dans la commune -->

					<h:panelGroup id="Suivi">
						<hr />

						
						<div class="col-sm-12" style="border: 1px solid white;">
									<p:dataTable  var="utilisateurProviver"  selectionMode="single"
					value="#{managerManagedBean.listPVOfCommune}" selection="#{managerManagedBean.selectedMiseEnplaceDTOPointDeVente}"
					rowKey="#{utilisateurProviver.idPointDeVente}" reflow="true" row="5"
					style="width: 90%; margin-left:5%; font-size:15px ; "
					emptyMessage="Aucune mise en place trouvée!!!" paginator="true"
					paginatorPosition="bottom" rows="11"
					paginatorTemplate="{PreviousPageLink} {NextPageLink} ">


								<p:column headerText="Point de Vente">  
								         #{entiteJMB.StringCutter(utilisateurProviver.nomPointDeVente,80)} 
								        </p:column>

								<p:column headerText="Responsable">  
								         #{entiteJMB.StringCutter(utilisateurProviver.nomGerant,40)} 
								        </p:column>

								
								<p:column headerText="Intrant">  
								         #{entiteJMB.StringCutter(utilisateurProviver.libelleIntrantAMettreEnplace,20)} 
								        </p:column>

								<p:column headerText="Quota">  
								         #{entiteJMB.StringCutter(utilisateurProviver.quotaIntrantAMettreEnplace, 20)} 
								        </p:column>
								        
								
								<p:column headerText="Reliquat">  
								         #{entiteJMB.StringCutter(utilisateurProviver.reliquatIntrantAMettreEnplace,20)} 
								        </p:column>
								   
								   <p:column headerText="Cumul">  
								         #{entiteJMB.StringCutter(utilisateurProviver.cumulIntrantAMettreEnplace, 20)} 
								        </p:column>     

	
							</p:dataTable> <br /><br /><br />
				
				
				
				
				
						</div><br />



						


<!-- 						<div id="buttons" class="pull-right" -->
<!-- 							style="margin-top: 50px; margin-right: 80px"> -->
<!-- 							<h:commandLink title="Enregistrer la mise en place " -->
<!-- 								action="#{agentSaisieMB.saveAndPreviewPlanMiseEnPlace}"> -->
<!-- 								<img style="margin-left: 60px ! important; margin-top: 20px;" -->
<!-- 									height="120px" src="assets/images/enre.jpg" alt="Logo PGCA" /> -->



<!-- 								<f:setPropertyActionListener target="#{agentSaisieMB.mPintrant}" -->
<!-- 									value="#{referentielMB.selectedIntrantDTO.idProduit}" /> -->
<!-- 								<f:setPropertyActionListener -->
<!-- 									target="#{agentSaisieMB.mPprogramme}" -->
<!-- 									value="#{referentielMB.libelleAndProg}" /> -->
<!-- 								<f:setPropertyActionListener -->
<!-- 									target="#{agentSaisieMB.dateMiseEnPlaceString}" -->
<!-- 									value="#{referentielMB.selectedIntrantDTO.dateMiseEnPlaceString}" /> -->



<!-- 							</h:commandLink> -->

<!-- 						</div> -->



					</h:panelGroup>

				</div>


			</h:form>
						

		
		
							
							

				<!--  Details credits  -->

				<h:form rendered="#{param.idBlocToShow eq '5c'}">

					

						<br />

						<div class="container-fluid">
							<h1 class="labelCustum"
							style="text-align: center; color: #49b97e; TEXT-ALIGN: center; FONT-SIZE: 25PX;">
							<span
								class="badge #{managerManagedBean.commandeDTO.styleClassCSSstatusCMD}"
								style="height: 40px; padding-top: 10px; font-size: 200px">
								<i class="fa #{managerManagedBean.commandeDTO.styleClassCSSstatusCMD}"
								aria-hidden="true" /> Crédit  N°
								#{managerManagedBean.selectedCreditDTO.credit_id}
							</span>
						</h1>
						
							<br />
											<p:messages id="msgJ" showDetail="true" />
						

							<div class="col-lg-6">
												<p > Historique des acomptes </p>
												<p:repeat value="#{managerManagedBean.listeAvance}" var="car">
												
											 	
											 	    <ul class="timeline">
													<li class="timeline">
															<div class="tl-circ">
															<i class="fa fa-chevron-down" aria-hidden="true"></i>
																
															</div>
															<div class="timeline-panel">
																<div class="tl-heading">
																	<h4>Paiement #{car.moyenPaiement} </h4>
																	<p>
																	<br/>
																		<small class="text-muted"><i
																			class="glyphicon glyphicon-time"></i> #{car.dateAvance}</small>
																	</p>
																</div>
																<br/>
																<div class="tl-body">
																	<p>#{car.montanance} CFA payé par #{car.auteurPaiement}</p>

																
																</div>
															</div>
													</li>
													</ul>
												</p:repeat>
												
							</div>
						
				
								<div class="col-lg-5">
								
								
													
									<div class="col-lg-12">

										<div class="form-group ">
											<i class="fa fa-2x fa-user" aria-hidden="true"></i> <span
												class="montantCFA">Responsable </span>
										</div>
										<hr />


										<div class="form-group row">
											<label class="col-xs-4 col-form-label"> Auteur </label>
											<div class="col-xs-8">
												<h:outputLabel class=" "
													value="#{managerManagedBean.selectedCreditDTO.auteurCreditLibelle} "></h:outputLabel>
											</div>
										</div>

										<div class="form-group row">
											<label class="col-xs-4 col-form-label">Tél Client </label>
											<div class="col-xs-8">
												<h:outputLabel class=" "
													value="#{managerManagedBean.selectedCreditDTO.telSouscripteur} "></h:outputLabel>
											</div>
										</div>

						<br/>

									</div>

									<div class="col-lg-12">
										<div class="form-group ">
											<span
												class="montantCFA">Détails </span>
										</div>
										<hr />

										<div class="form-group row">
										<div class="col-xs-12">
											
											<h:outputLabel class=" "
													value="#{managerManagedBean.selectedCreditDTO.resumeCredit} "></h:outputLabel>
											</div>
										</div>  <br/>

									


									</div>
									
									
									<div class="col-lg-12">
										
										<hr />

										<div class="form-group row">
										<div class="col-xs-12">
											
												<h1 class="titrePage Margin10 montantCFA "
																		style="font-size: 20px"><p>Restant à payer </p> <br/>
																		#{referentielMB.utils.formatFloatToCFA(managerManagedBean.selectedCreditDTO.montantRestantApayer)}
																		
																	</h1>
																	</div>
										</div>  <br/>

									</div>
								
							</div>
						</div>

						<div id="buttons" class="pull-right" style="margin-top: 10px">
							<a type="submit" style="margin-right: 22px; width: 150px"
								href="ManagerGestionCredits.xhtml"
								class="fa fa-info btn btn-default pull-right"> Retour</a>
						</div>

					</h:form>
				
				
					
				<h:form rendered="#{param.idBlocToShow eq '5b'}">
					<p:messages id="msgF" showDetail="true" />

						<h1 class="labelCustum"
							style="text-align: center; color: #49b97e; TEXT-ALIGN: center; FONT-SIZE: 25PX;">
							<span
								class="badge #{managerManagedBean.commandeDTO.styleClassCSSstatusCMD}"
								style="height: 40px; padding-top: 10px; font-size: 200px">
								<i class="fa #{managerManagedBean.commandeDTO.styleClassCSSstatusCMD}"
								aria-hidden="true" /> Ordre N°
								#{managerManagedBean.selectedCreditDTO.credit_id}
						
							</span>
						</h1>

						<br />

						<div class="container-fluid">
							<br />
							

							<div class="col-lg-4">
								
					

					
						<!-- -  FIN Avnce sur credit -->
						
							</div>
							
				
								
										
											<!-- Data BL -->
											<div class="row"
												style="border-top: 2px solid #ffffff; height: 220px;">
												
																<h1 class="titrePage Margin10  " style="text-align :center"> Enregistrement d'un acompte   </h1>
												
												<div class="col-xs-6">
												<br/> <br/><br/>
														<h1 class="titrePage Margin10 montantCFA "
																		style="font-size: 20px">Restant à payer : <br/>
																		#{referentielMB.utils.formatFloatToCFA(managerManagedBean.selectedCreditDTO.montantRestantApayer)}
																		
																	</h1>
												</div>					
												<div class="col-xs-6">
													
													<br/>

																<div class="form-group">
																	<label for="inputEmail3" class="col-sm-4 control-label">
																		Moyen Paiement
																	</label>
																	<div class="col-sm-8">

																		<h:selectOneMenu
																			value="#{managerManagedBean.avanceDTO.moyenPaiement}"
																			required="true"
																			styleClass="form-control input-sm CustomSelect"
																			requiredMessage="Il faut au minimum un produit par BL ">
																			<f:selectItem itemLabel="Selectionnez un produit "
																				itemValue="" />
																			<f:selectItem itemLabel="Espéces" itemValue="1" />
																			<f:selectItem itemLabel="Chéque " itemValue="2" />
																			<f:selectItem itemLabel="Bon subvention "
																				itemValue="3" />
																			<f:selectItem itemLabel="Nature" itemValue="4" />

																		</h:selectOneMenu>
																	</div>
																</div>
																<br />


																<div class="form-group" style="margin-top: 20px">
																	<label for="inputPassword3"
																		class="col-sm-4 control-label"> Montant</label>
																	<div class="col-sm-8">
																		<p:inputText type="number"
																			requiredMessage="Le poids est requis"
																			value="#{managerManagedBean.avanceDTO.montanance}"
																			styleClass="form-control" title="L'quantite" />
																		<br />
																	</div>
																	<br />
																</div>


																<div class="form-group" style="margin-top: 20px">
																	<label for="inputPassword3"
																		class="col-sm-4 control-label"> Auteur</label>
																	<div class="col-sm-8">
																		<p:inputText 
																			requiredMessage="Le poids est requis"
																			value="#{managerManagedBean.avanceDTO.auteurPaiement}"
																			styleClass="form-control" title="L'quantite" />
																		<br /> <br />
																	</div>

																</div>


																<br /> <br /> <br />

																<h:commandButton
																	styleClass=" btn  pull-right btn-success"
																	update=" form1:totalCharge"
																	style="width : 150px ; margin-right : 12px"
																	action="#{managerManagedBean.callServiceAvanceSurCredit()}"
																	value=" Enregistrer" name="suivants">


																</h:commandButton>
																<a type="submit" style="margin-right: 22px; width: 150px"
								href="ManagerGestionCredits.xhtml"
								class="fa fa-info btn btn-default pull-right"> Retour</a>
																<br /> <br /> <br />

												</div>

											</div>
											<br />
									

							
							
							
						</div>

				
				
		
					</h:form>
				
					
			</div>



		</div>



	</ui:define>

</ui:composition>
